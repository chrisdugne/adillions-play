<!DOCTYPE html>

<html>
<head>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<title>Adillions - Login</title>
<link rel="shortcut icon" type="image/png" href='@routes.Assets.at("images/favicon.png")'>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/bootstrap.min.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/header.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/mobile.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/classic/footer.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/classic/global.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/classic/home.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/medium/footer.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/medium/global.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/medium/home.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/facebook/footer.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/facebook/global.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/facebook/home.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/small/footer.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/small/global.css")' />
<link rel="stylesheet" media="screen" href='@routes.Assets.at("css/small/home.css")' />
</head>

@import views.html.mobile.header;

<body>
	@header()

	<div class="content">
		<img id="closeButton" src='@routes.Assets.at("images/ko.png")' class="mobilecloser"></img>

		<div class="row-fluid">
			<div id="facebookButton" class="btn-large button-facebook">Connect with Facebook</div>
		</div>
		<div class="row-fluid">
			<p class="auth-method-separator">
            	<i>or</i>
        	</p>
		</div>

		<div id="login" class="row-fluid">

			<form id="loginForm">

				<div class="clearfix  " id="email_field">
					<label for="loginemail">E-mail</label>
					<div class="input">
						<input type="text" id="loginemail" name="loginemail" value="">
					</div>
				</div>

				<div class="clearfix  " id="password_field">
					<label for="loginpassword">Password</label>
					<div class="input">
						<input type="password" id="loginpassword" name="loginpassword">
					</div>
				</div>

			</form>

			<div id="validateButton" class="btn-large button">Log in</div>

		</div>

	</div>

</body>


<!-- Libs -->
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script type="text/javascript" src='@routes.Assets.at("js/libs/jquery.ui.touch-punch.min.js")'></script>

<!-- Facebook --->
<script src="https://connect.facebook.net/en_US/all.js" type="text/javascript"></script>

<script src='@routes.Assets.at("js/libs/jquery.blockUI.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/libs/sha512.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/libs/jquery.validate.min.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/libs/spin.min.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/libs/jquery.cookie.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/webapp/tools/facebook.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/webapp/managers/userManager.js")' type="text/javascript"></script>
<script src='@routes.Assets.at("js/webapp/app-common.js")' type="text/javascript"></script>


<script type="text/javascript">
   UserManager.setupForms()

   var failure = function() {
      Facebook.logout()
   }
   var finalize 		= function() {}
   var loginSuccess 	= function() {
      // already logged in 
      var url = "/ok"
      url += "?access_token=" + Facebook.accessToken
      window.location.href = url
   }

   Facebook.init(finalize, failure, loginSuccess)

   $("#facebookButton").click(function() {
      Facebook.popupLogin()  
   })
   
   $("#validateButton").click(function() {
      UserManager.mobileLogin(function(result) {
         if (result) {
            var url = "/loggedin"
            url += "?authToken=" + result.authToken
            window.location.href = url

         } else {
            App.message("Wrong login/password", false)
         }
      })
   });

   $("#closeButton").click(function() {
      window.location.href = "/backToMobile"
   });
</script>

</html>
